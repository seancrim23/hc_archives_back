#TODO build this out with unit tests